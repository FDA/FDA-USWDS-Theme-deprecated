{"version":3,"sources":["src/patterns/components/usa-file-input/file-input.js"],"names":["select","require","behavior","PREFIX","prefix","DROPZONE_CLASS","DROPZONE","INPUT_CLASS","TARGET_CLASS","BOX_CLASS","INSTRUCTIONS_CLASS","PREVIEW_CLASS","PREVIEW_HEADING_CLASS","CHOOSE_CLASS","ACCEPTED_FILE_MESSAGE_CLASS","DRAG_TEXT_CLASS","DRAG_CLASS","LOADING_CLASS","HIDDEN_CLASS","INVALID_FILE_CLASS","GENERIC_PREVIEW_CLASS_NAME","GENERIC_PREVIEW_CLASS","PDF_PREVIEW_CLASS","WORD_PREVIEW_CLASS","VIDEO_PREVIEW_CLASS","EXCEL_PREVIEW_CLASS","SPACER_GIF","makeSafeForID","name","replace","replaceName","s","c","charCodeAt","toLowerCase","toString","slice","buildFileInput","fileInputEl","acceptsMultiple","hasAttribute","fileInputParent","document","createElement","dropTarget","box","instructions","classList","remove","add","setAttribute","parentNode","insertBefore","appendChild","innerHTML","test","navigator","userAgent","querySelector","outerHTML","removeOldPreviews","filePreviews","querySelectorAll","currentPreviewHeading","currentErrorMessage","Array","prototype","forEach","call","removeImages","node","removeChild","preventInvalidFiles","e","acceptedFiles","getAttribute","errorMessage","allFilesAllowed","i","dataTransfer","files","length","file","indexOf","value","preventDefault","stopPropagation","handleChange","fileNames","target","filePreviewsHeading","reader","FileReader","fileName","onloadstart","createLoadingImage","imageId","previewImage","insertAdjacentHTML","onloadend","createFilePreview","getElementById","src","result","readAsDataURL","fileInput","init","root","addEventListener","handleDragOver","handleDragLeave","handleDrop","onchange","module","exports"],"mappings":"AAAA;;AACA,IAAMA,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AACA,IAAMC,QAAQ,GAAGD,OAAO,CAAC,yBAAD,CAAxB;;eAC2BA,OAAO,CAAC,iBAAD,C;IAAlBE,M,YAARC,M;;AAER,IAAMC,cAAc,aAAMF,MAAN,gBAApB;AACA,IAAMG,QAAQ,cAAOD,cAAP,CAAd;AACA,IAAME,WAAW,aAAMJ,MAAN,uBAAjB;AACA,IAAMK,YAAY,aAAML,MAAN,wBAAlB;AACA,IAAMM,SAAS,aAAMN,MAAN,qBAAf;AACA,IAAMO,kBAAkB,aAAMP,MAAN,8BAAxB;AACA,IAAMQ,aAAa,aAAMR,MAAN,yBAAnB;AACA,IAAMS,qBAAqB,aAAMT,MAAN,iCAA3B;AACA,IAAMU,YAAY,aAAMV,MAAN,wBAAlB;AACA,IAAMW,2BAA2B,aAAMX,MAAN,wCAAjC;AACA,IAAMY,eAAe,aAAMZ,MAAN,2BAArB;AACA,IAAMa,UAAU,aAAMb,MAAN,sBAAhB;AACA,IAAMc,aAAa,GAAG,YAAtB;AACA,IAAMC,YAAY,GAAG,cAArB;AACA,IAAMC,kBAAkB,GAAG,kBAA3B;AACA,IAAMC,0BAA0B,aAAMjB,MAAN,gCAAhC;AACA,IAAMkB,qBAAqB,aAAMD,0BAAN,cAA3B;AACA,IAAME,iBAAiB,aAAMF,0BAAN,UAAvB;AACA,IAAMG,kBAAkB,aAAMH,0BAAN,WAAxB;AACA,IAAMI,mBAAmB,aAAMJ,0BAAN,YAAzB;AACA,IAAMK,mBAAmB,aAAML,0BAAN,YAAzB;AACA,IAAMM,UAAU,GACd,gFADF;AAGA;;;;;;AAKA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAU;AAC9B,SAAOA,IAAI,CAACC,OAAL,CAAa,YAAb,EAA2B,SAASC,WAAT,CAAqBC,CAArB,EAAwB;AACxD,QAAMC,CAAC,GAAGD,CAAC,CAACE,UAAF,CAAa,CAAb,CAAV;;AACA,QAAID,CAAC,KAAK,EAAV,EAAc;AACZ,aAAO,GAAP;AACD;;AACD,QAAIA,CAAC,IAAI,EAAL,IAAWA,CAAC,IAAI,EAApB,EAAwB;AACtB,2BAAcD,CAAC,CAACG,WAAF,EAAd;AACD;;AACD,uBAAY,CAAC,OAAOF,CAAC,CAACG,QAAF,CAAW,EAAX,CAAR,EAAwBC,KAAxB,CAA8B,CAAC,CAA/B,CAAZ;AACD,GATM,CAAP;AAUD,CAXD;AAaA;;;;;;;AAKA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,WAAD,EAAiB;AACtC,MAAMC,eAAe,GAAGD,WAAW,CAACE,YAAZ,CAAyB,UAAzB,CAAxB;AACA,MAAMC,eAAe,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAxB;AACA,MAAMC,UAAU,GAAGF,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAnB;AACA,MAAME,GAAG,GAAGH,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAZ;AACA,MAAMG,YAAY,GAAGJ,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAArB,CALsC,CAOtC;;AACAL,EAAAA,WAAW,CAACS,SAAZ,CAAsBC,MAAtB,CAA6B3C,cAA7B;AACAiC,EAAAA,WAAW,CAACS,SAAZ,CAAsBE,GAAtB,CAA0B1C,WAA1B;AACAkC,EAAAA,eAAe,CAACM,SAAhB,CAA0BE,GAA1B,CAA8B5C,cAA9B;AACAwC,EAAAA,GAAG,CAACE,SAAJ,CAAcE,GAAd,CAAkBxC,SAAlB;AACAqC,EAAAA,YAAY,CAACC,SAAb,CAAuBE,GAAvB,CAA2BvC,kBAA3B;AACAoC,EAAAA,YAAY,CAACI,YAAb,CAA0B,aAA1B,EAAyC,MAAzC;AACAN,EAAAA,UAAU,CAACG,SAAX,CAAqBE,GAArB,CAAyBzC,YAAzB,EAdsC,CAgBtC;;AACA8B,EAAAA,WAAW,CAACa,UAAZ,CAAuBC,YAAvB,CAAoCR,UAApC,EAAgDN,WAAhD;AACAA,EAAAA,WAAW,CAACa,UAAZ,CAAuBC,YAAvB,CAAoCX,eAApC,EAAqDG,UAArD;AACAA,EAAAA,UAAU,CAACS,WAAX,CAAuBf,WAAvB;AACAG,EAAAA,eAAe,CAACY,WAAhB,CAA4BT,UAA5B;AACAN,EAAAA,WAAW,CAACa,UAAZ,CAAuBC,YAAvB,CAAoCN,YAApC,EAAkDR,WAAlD;AACAA,EAAAA,WAAW,CAACa,UAAZ,CAAuBC,YAAvB,CAAoCP,GAApC,EAAyCP,WAAzC,EAtBsC,CAwBtC;;AACA,MAAIC,eAAJ,EAAqB;AACnBO,IAAAA,YAAY,CAACQ,SAAb,2BAAyCvC,eAAzC,wDAAoGF,YAApG;AACD,GAFD,MAGK;AACHiC,IAAAA,YAAY,CAACQ,SAAb,2BAAyCvC,eAAzC,uDAAmGF,YAAnG;AACD,GA9BqC,CAgCtC;;;AACA,MACE,WAAW0C,IAAX,CAAgBC,SAAS,CAACC,SAA1B,KACA,aAAaF,IAAb,CAAkBC,SAAS,CAACC,SAA5B,CAFF,EAGE;AACAhB,IAAAA,eAAe,CAACiB,aAAhB,YAAkC3C,eAAlC,GAAqD4C,SAArD,GAAiE,EAAjE;AACD;;AAED,SAAO;AAAEb,IAAAA,YAAY,EAAZA,YAAF;AAAgBF,IAAAA,UAAU,EAAVA;AAAhB,GAAP;AACD,CAzCD;AA2CA;;;;;;;AAKA,IAAMgB,iBAAiB,GAAG,SAApBA,iBAAoB,CAAChB,UAAD,EAAaE,YAAb,EAA8B;AACtD,MAAMe,YAAY,GAAGjB,UAAU,CAACkB,gBAAX,YAAgCnD,aAAhC,EAArB;AACA,MAAMoD,qBAAqB,GAAGnB,UAAU,CAACc,aAAX,YACxB9C,qBADwB,EAA9B;AAGA,MAAMoD,mBAAmB,GAAGpB,UAAU,CAACc,aAAX,YACtB5C,2BADsB,EAA5B,CALsD,CAStD;;AACA,MAAIiD,qBAAJ,EAA2B;AACzBA,IAAAA,qBAAqB,CAACJ,SAAtB,GAAkC,EAAlC;AACD,GAZqD,CActD;;;AACA,MAAIK,mBAAJ,EAAyB;AACvBA,IAAAA,mBAAmB,CAACL,SAApB,GAAgC,EAAhC;AACAf,IAAAA,UAAU,CAACG,SAAX,CAAqBC,MAArB,CAA4B7B,kBAA5B;AACD,GAlBqD,CAoBtD;;;AACA,MAAI0C,YAAY,KAAK,IAArB,EAA2B;AACzB,QAAIf,YAAJ,EAAkB;AAChBA,MAAAA,YAAY,CAACC,SAAb,CAAuBC,MAAvB,CAA8B9B,YAA9B;AACD;;AACD+C,IAAAA,KAAK,CAACC,SAAN,CAAgBC,OAAhB,CAAwBC,IAAxB,CAA6BP,YAA7B,EAA2C,SAASQ,YAAT,CAAsBC,IAAtB,EAA4B;AACrEA,MAAAA,IAAI,CAACnB,UAAL,CAAgBoB,WAAhB,CAA4BD,IAA5B;AACD,KAFD;AAGD;AACF,CA7BD;AA+BA;;;;;;;;;;;;AAUA,IAAME,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,CAAD,EAAInC,WAAJ,EAAiBQ,YAAjB,EAA+BF,UAA/B,EAA8C;AACxE,MAAM8B,aAAa,GAAGpC,WAAW,CAACqC,YAAZ,CAAyB,QAAzB,CAAtB;AACA/B,EAAAA,UAAU,CAACG,SAAX,CAAqBC,MAArB,CAA4B7B,kBAA5B,EAFwE,CAIxE;;AACA,MAAIuD,aAAJ,EAAmB;AACjB,QAAME,YAAY,GAAGlC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAArB,CADiB,CAGjB;;AACA,QAAIkC,eAAe,GAAG,IAAtB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,CAAC,CAACM,YAAF,CAAeC,KAAf,CAAqBC,MAAzC,EAAiDH,CAAC,IAAI,CAAtD,EAAyD;AACvD,UAAMI,IAAI,GAAGT,CAAC,CAACM,YAAF,CAAeC,KAAf,CAAqBF,CAArB,CAAb;;AACA,UAAID,eAAJ,EAAqB;AACnBA,QAAAA,eAAe,GAAGK,IAAI,CAACtD,IAAL,CAAUuD,OAAV,CAAkBT,aAAlB,CAAlB;;AACA,YAAIG,eAAe,GAAG,CAAtB,EAAyB;AACvB;AACD;AACF;AACF,KAbgB,CAejB;;;AACA,QAAIA,eAAe,GAAG,CAAtB,EAAyB;AACvBjB,MAAAA,iBAAiB,CAAChB,UAAD,EAAaE,YAAb,CAAjB;AACAR,MAAAA,WAAW,CAAC8C,KAAZ,GAAoB,EAApB,CAFuB,CAEC;;AACxBxC,MAAAA,UAAU,CAACQ,YAAX,CAAwBwB,YAAxB,EAAsCtC,WAAtC;AACAsC,MAAAA,YAAY,CAACtB,SAAb,gCAA+CoB,aAA/C;AACAE,MAAAA,YAAY,CAAC7B,SAAb,CAAuBE,GAAvB,CAA2BnC,2BAA3B;AACA8B,MAAAA,UAAU,CAACG,SAAX,CAAqBE,GAArB,CAAyB9B,kBAAzB;AACAsD,MAAAA,CAAC,CAACY,cAAF;AACAZ,MAAAA,CAAC,CAACa,eAAF;AACD;AACF;AACF,CAhCD;AAkCA;;;;;;;;;;AAQA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACd,CAAD,EAAInC,WAAJ,EAAiBQ,YAAjB,EAA+BF,UAA/B,EAA8C;AACjE,MAAM4C,SAAS,GAAGf,CAAC,CAACgB,MAAF,CAAST,KAA3B;AACA,MAAMU,mBAAmB,GAAGhD,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAA5B,CAFiE,CAIjE;;AACAiB,EAAAA,iBAAiB,CAAChB,UAAD,EAAaE,YAAb,CAAjB,CALiE,CAOjE;;AAPiE,6BAQxDgC,CARwD;AAS/D,QAAMa,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACA,QAAMC,QAAQ,GAAGL,SAAS,CAACV,CAAD,CAAT,CAAalD,IAA9B,CAV+D,CAY/D;;AACA+D,IAAAA,MAAM,CAACG,WAAP,GAAqB,SAASC,kBAAT,GAA8B;AACjD,UAAMC,OAAO,GAAGrE,aAAa,CAACkE,QAAD,CAA7B;AACA,UAAMI,YAAY,uBAAeD,OAAf,sBAAgCtE,UAAhC,iEAA6FT,aAA7F,SAAlB;AAEA6B,MAAAA,YAAY,CAACoD,kBAAb,CACE,UADF,yBAEiBvF,aAFjB,qCAEsDsF,YAFtD,SAEqEJ,QAFrE;AAID,KARD,CAb+D,CAuB/D;;;AACAF,IAAAA,MAAM,CAACQ,SAAP,GAAmB,SAASC,iBAAT,GAA6B;AAC9C,UAAMJ,OAAO,GAAGrE,aAAa,CAACkE,QAAD,CAA7B;AACA,UAAMI,YAAY,GAAGvD,QAAQ,CAAC2D,cAAT,CAAwBL,OAAxB,CAArB;;AACA,UAAIH,QAAQ,CAACV,OAAT,CAAiB,MAAjB,IAA2B,CAA/B,EAAkC;AAChCc,QAAAA,YAAY,CAAC/C,YAAb,CACE,SADF,yCAEiCxB,UAFjC,sCAEqEJ,iBAFrE;AAID,OALD,MAMK,IACHuE,QAAQ,CAACV,OAAT,CAAiB,MAAjB,IAA2B,CAA3B,IACAU,QAAQ,CAACV,OAAT,CAAiB,QAAjB,IAA6B,CAF1B,EAGH;AACAc,QAAAA,YAAY,CAAC/C,YAAb,CACE,SADF,yCAEiCxB,UAFjC,sCAEqEH,kBAFrE;AAID,OARI,MASA,IACHsE,QAAQ,CAACV,OAAT,CAAiB,MAAjB,IAA2B,CAA3B,IACAU,QAAQ,CAACV,OAAT,CAAiB,UAAjB,IAA+B,CAF5B,EAGH;AACAc,QAAAA,YAAY,CAAC/C,YAAb,CACE,SADF,yCAEiCxB,UAFjC,sCAEqED,mBAFrE;AAID,OARI,MASA,IAAIoE,QAAQ,CAACV,OAAT,CAAiB,MAAjB,IAA2B,CAA3B,IAAgCU,QAAQ,CAACV,OAAT,CAAiB,MAAjB,IAA2B,CAA/D,EAAkE;AACrEc,QAAAA,YAAY,CAAC/C,YAAb,CACE,SADF,yCAEiCxB,UAFjC,sCAEqEF,mBAFrE;AAID,OALI,MAMA;AACHyE,QAAAA,YAAY,CAAC/C,YAAb,CACE,SADF,yCAEiCxB,UAFjC,sCAEqEL,qBAFrE;AAID,OAtC6C,CAwC9C;;;AACA4E,MAAAA,YAAY,CAAClD,SAAb,CAAuBC,MAAvB,CAA8B/B,aAA9B;AACAgF,MAAAA,YAAY,CAACK,GAAb,GAAmBX,MAAM,CAACY,MAA1B;AACD,KA3CD;;AA6CA,QAAIf,SAAS,CAACV,CAAD,CAAb,EAAkB;AAChBa,MAAAA,MAAM,CAACa,aAAP,CAAqBhB,SAAS,CAACV,CAAD,CAA9B;AACD,KAvE8D,CAyE/D;;;AACA,QAAIA,CAAC,KAAK,CAAV,EAAa;AACXlC,MAAAA,UAAU,CAACQ,YAAX,CAAwBsC,mBAAxB,EAA6C5C,YAA7C;AACA4C,MAAAA,mBAAmB,CAACpC,SAApB,GACE,uEADF;AAED,KAJD,MAKK,IAAIwB,CAAC,IAAI,CAAT,EAAY;AACflC,MAAAA,UAAU,CAACQ,YAAX,CAAwBsC,mBAAxB,EAA6C5C,YAA7C;AACA4C,MAAAA,mBAAmB,CAACpC,SAApB,aAAmCwB,CAAC,GAClC,CADF;AAED,KAnF8D,CAqF/D;;;AACA,QAAIY,mBAAJ,EAAyB;AACvB5C,MAAAA,YAAY,CAACC,SAAb,CAAuBE,GAAvB,CAA2B/B,YAA3B;AACAwE,MAAAA,mBAAmB,CAAC3C,SAApB,CAA8BE,GAA9B,CAAkCrC,qBAAlC;AACD;AAzF8D;;AAQjE,OAAK,IAAIkE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,SAAS,CAACP,MAA9B,EAAsCH,CAAC,IAAI,CAA3C,EAA8C;AAAA,UAArCA,CAAqC;AAkF7C;AACF,CA3FD;;AA6FA,IAAM2B,SAAS,GAAGvG,QAAQ,CACxB,EADwB,EAExB;AACEwG,EAAAA,IADF,gBACOC,IADP,EACa;AACT3G,IAAAA,MAAM,CAACM,QAAD,EAAWqG,IAAX,CAAN,CAAuBxC,OAAvB,CAA+B,UAAC7B,WAAD,EAAiB;AAAA,4BACTD,cAAc,CAACC,WAAD,CADL;AAAA,UACtCQ,YADsC,mBACtCA,YADsC;AAAA,UACxBF,UADwB,mBACxBA,UADwB;;AAG9CA,MAAAA,UAAU,CAACgE,gBAAX,CACE,UADF,EAEE,SAASC,cAAT,GAA0B;AACxB,aAAK9D,SAAL,CAAeE,GAAf,CAAmBjC,UAAnB;AACD,OAJH,EAKE,KALF;AAQA4B,MAAAA,UAAU,CAACgE,gBAAX,CACE,WADF,EAEE,SAASE,eAAT,GAA2B;AACzB,aAAK/D,SAAL,CAAeC,MAAf,CAAsBhC,UAAtB;AACD,OAJH,EAKE,KALF;AAQA4B,MAAAA,UAAU,CAACgE,gBAAX,CACE,MADF,EAEE,SAASG,UAAT,CAAoBtC,CAApB,EAAuB;AACrBD,QAAAA,mBAAmB,CAACC,CAAD,EAAInC,WAAJ,EAAiBQ,YAAjB,EAA+BF,UAA/B,CAAnB;AACA,aAAKG,SAAL,CAAeC,MAAf,CAAsBhC,UAAtB;AACD,OALH,EAME,KANF;;AASAsB,MAAAA,WAAW,CAAC0E,QAAZ,GAAuB,UAACvC,CAAD,EAAO;AAC5B;AACAc,QAAAA,YAAY,CAACd,CAAD,EAAInC,WAAJ,EAAiBQ,YAAjB,EAA+BF,UAA/B,CAAZ;AACD,OAHD;AAID,KAhCD;AAiCD;AAnCH,CAFwB,CAA1B;AAyCAqE,MAAM,CAACC,OAAP,GAAiBT,SAAjB","sourcesContent":["'use strict';\r\nconst select = require('../../../utils/select');\r\nconst behavior = require('../../../utils/behavior');\r\nconst { prefix: PREFIX } = require('../../../config');\r\n\r\nconst DROPZONE_CLASS = `${PREFIX}-file-input`;\r\nconst DROPZONE = `.${DROPZONE_CLASS}`;\r\nconst INPUT_CLASS = `${PREFIX}-file-input__input`;\r\nconst TARGET_CLASS = `${PREFIX}-file-input__target`;\r\nconst BOX_CLASS = `${PREFIX}-file-input__box`;\r\nconst INSTRUCTIONS_CLASS = `${PREFIX}-file-input__instructions`;\r\nconst PREVIEW_CLASS = `${PREFIX}-file-input__preview`;\r\nconst PREVIEW_HEADING_CLASS = `${PREFIX}-file-input__preview-heading`;\r\nconst CHOOSE_CLASS = `${PREFIX}-file-input__choose`;\r\nconst ACCEPTED_FILE_MESSAGE_CLASS = `${PREFIX}-file-input__accepted-files-message`;\r\nconst DRAG_TEXT_CLASS = `${PREFIX}-file-input__drag-text`;\r\nconst DRAG_CLASS = `${PREFIX}-file-input--drag`;\r\nconst LOADING_CLASS = 'is-loading';\r\nconst HIDDEN_CLASS = 'display-none';\r\nconst INVALID_FILE_CLASS = 'has-invalid-file';\r\nconst GENERIC_PREVIEW_CLASS_NAME = `${PREFIX}-file-input__preview__image`;\r\nconst GENERIC_PREVIEW_CLASS = `${GENERIC_PREVIEW_CLASS_NAME}--generic`;\r\nconst PDF_PREVIEW_CLASS = `${GENERIC_PREVIEW_CLASS_NAME}--pdf`;\r\nconst WORD_PREVIEW_CLASS = `${GENERIC_PREVIEW_CLASS_NAME}--word`;\r\nconst VIDEO_PREVIEW_CLASS = `${GENERIC_PREVIEW_CLASS_NAME}--video`;\r\nconst EXCEL_PREVIEW_CLASS = `${GENERIC_PREVIEW_CLASS_NAME}--excel`;\r\nconst SPACER_GIF =\r\n  'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n\r\n/**\r\n * Creates an ID name for each file that strips all invalid characters.\r\n * @param {string} name - name of the file added to file input\r\n * @returns {string} same characters as the name with invalide chars removed\r\n */\r\nconst makeSafeForID = (name) => {\r\n  return name.replace(/[^a-z0-9]/g, function replaceName(s) {\r\n    const c = s.charCodeAt(0);\r\n    if (c === 32) {\r\n      return '-';\r\n    }\r\n    if (c >= 65 && c <= 90) {\r\n      return `img_${s.toLowerCase()}`;\r\n    }\r\n    return `__${('000', c.toString(16)).slice(-4)}`;\r\n  });\r\n};\r\n\r\n/**\r\n * Builds full file input comonent\r\n * @param {HTMLElement} fileInputEl - original file input on page\r\n * @returns {HTMLElement|HTMLElement} - Instructions, target area div\r\n */\r\nconst buildFileInput = (fileInputEl) => {\r\n  const acceptsMultiple = fileInputEl.hasAttribute('multiple');\r\n  const fileInputParent = document.createElement('div');\r\n  const dropTarget = document.createElement('div');\r\n  const box = document.createElement('div');\r\n  const instructions = document.createElement('div');\r\n\r\n  // Adds class names and other attributes\r\n  fileInputEl.classList.remove(DROPZONE_CLASS);\r\n  fileInputEl.classList.add(INPUT_CLASS);\r\n  fileInputParent.classList.add(DROPZONE_CLASS);\r\n  box.classList.add(BOX_CLASS);\r\n  instructions.classList.add(INSTRUCTIONS_CLASS);\r\n  instructions.setAttribute('aria-hidden', 'true');\r\n  dropTarget.classList.add(TARGET_CLASS);\r\n\r\n  // Adds child elements to the DOM\r\n  fileInputEl.parentNode.insertBefore(dropTarget, fileInputEl);\r\n  fileInputEl.parentNode.insertBefore(fileInputParent, dropTarget);\r\n  dropTarget.appendChild(fileInputEl);\r\n  fileInputParent.appendChild(dropTarget);\r\n  fileInputEl.parentNode.insertBefore(instructions, fileInputEl);\r\n  fileInputEl.parentNode.insertBefore(box, fileInputEl);\r\n\r\n  // Sets instruction test based on whether or not multipe files are accepted\r\n  if (acceptsMultiple) {\r\n    instructions.innerHTML = `<span class=\"${DRAG_TEXT_CLASS}\">Drag files here or </span><span class=\"${CHOOSE_CLASS}\">choose from folder</span>`;\r\n  }\r\n  else {\r\n    instructions.innerHTML = `<span class=\"${DRAG_TEXT_CLASS}\">Drag file here or </span><span class=\"${CHOOSE_CLASS}\">choose from folder</span>`;\r\n  }\r\n\r\n  // IE11 and Edge do not support drop files on file inputs, so we've removed text that indicates that\r\n  if (\r\n    /rv:11.0/i.test(navigator.userAgent) ||\r\n    /Edge\\/\\d./i.test(navigator.userAgent)\r\n  ) {\r\n    fileInputParent.querySelector(`.${DRAG_TEXT_CLASS}`).outerHTML = '';\r\n  }\r\n\r\n  return { instructions, dropTarget };\r\n};\r\n\r\n/**\r\n * Removes image previews, we want to start with a clean list every time files are added to the file input\r\n * @param {HTMLElement} dropTarget - target area div that encases the input\r\n * @param {HTMLElement} instructions - text to infrom users to drag or select files\r\n */\r\nconst removeOldPreviews = (dropTarget, instructions) => {\r\n  const filePreviews = dropTarget.querySelectorAll(`.${PREVIEW_CLASS}`);\r\n  const currentPreviewHeading = dropTarget.querySelector(\r\n    `.${PREVIEW_HEADING_CLASS}`\r\n  );\r\n  const currentErrorMessage = dropTarget.querySelector(\r\n    `.${ACCEPTED_FILE_MESSAGE_CLASS}`\r\n  );\r\n\r\n  // Remove the heading above the previews\r\n  if (currentPreviewHeading) {\r\n    currentPreviewHeading.outerHTML = '';\r\n  }\r\n\r\n  // Remove existing error messages\r\n  if (currentErrorMessage) {\r\n    currentErrorMessage.outerHTML = '';\r\n    dropTarget.classList.remove(INVALID_FILE_CLASS);\r\n  }\r\n\r\n  // Get rid of existing previews if they exist, show instructions\r\n  if (filePreviews !== null) {\r\n    if (instructions) {\r\n      instructions.classList.remove(HIDDEN_CLASS);\r\n    }\r\n    Array.prototype.forEach.call(filePreviews, function removeImages(node) {\r\n      node.parentNode.removeChild(node);\r\n    });\r\n  }\r\n};\r\n\r\n/**\r\n * When using an Accept attribute, invalid files will be hidden from\r\n * file browser, but they can still be dragged to the input. This\r\n * function prevents them from being dragged and removes error states\r\n * when correct files are added.\r\n * @param {event} e\r\n * @param {HTMLElement} fileInputEl - file input element\r\n * @param {HTMLElement} instructions - text to infrom users to drag or select files\r\n * @param {HTMLElement} dropTarget - target area div that encases the input\r\n */\r\nconst preventInvalidFiles = (e, fileInputEl, instructions, dropTarget) => {\r\n  const acceptedFiles = fileInputEl.getAttribute('accept');\r\n  dropTarget.classList.remove(INVALID_FILE_CLASS);\r\n\r\n  // Runs if only specific files are accepted\r\n  if (acceptedFiles) {\r\n    const errorMessage = document.createElement('div');\r\n\r\n    // If multiple files are dragged, this iterates through them and look for any files that are not accepted.\r\n    let allFilesAllowed = true;\r\n    for (let i = 0; i < e.dataTransfer.files.length; i += 1) {\r\n      const file = e.dataTransfer.files[i];\r\n      if (allFilesAllowed) {\r\n        allFilesAllowed = file.name.indexOf(acceptedFiles);\r\n        if (allFilesAllowed < 0) {\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // If dragged files are not accepted, this removes them from the value of the input and creates and error state\r\n    if (allFilesAllowed < 0) {\r\n      removeOldPreviews(dropTarget, instructions);\r\n      fileInputEl.value = ''; // eslint-disable-line no-param-reassign\r\n      dropTarget.insertBefore(errorMessage, fileInputEl);\r\n      errorMessage.innerHTML = `Please attach only ${acceptedFiles} files`;\r\n      errorMessage.classList.add(ACCEPTED_FILE_MESSAGE_CLASS);\r\n      dropTarget.classList.add(INVALID_FILE_CLASS);\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n};\r\n\r\n/**\r\n * When new files are applied to file input, this function generates previews\r\n * and removes old ones.\r\n * @param {event} e\r\n * @param {HTMLElement} fileInputEl - file input element\r\n * @param {HTMLElement} instructions - text to infrom users to drag or select files\r\n * @param {HTMLElement} dropTarget - target area div that encases the input\r\n */\r\nconst handleChange = (e, fileInputEl, instructions, dropTarget) => {\r\n  const fileNames = e.target.files;\r\n  const filePreviewsHeading = document.createElement('div');\r\n\r\n  // First, get rid of existing previews\r\n  removeOldPreviews(dropTarget, instructions);\r\n\r\n  // Iterates through files list and creates previews\r\n  for (let i = 0; i < fileNames.length; i += 1) {\r\n    const reader = new FileReader();\r\n    const fileName = fileNames[i].name;\r\n\r\n    // Starts with a loading image while preview is created\r\n    reader.onloadstart = function createLoadingImage() {\r\n      const imageId = makeSafeForID(fileName);\r\n      const previewImage = `<img id=\"${imageId}\" src=\"${SPACER_GIF}\" alt=\"\" class=\"usa-file-input__preview__image  ${LOADING_CLASS}\"/>`;\r\n\r\n      instructions.insertAdjacentHTML(\r\n        'afterend',\r\n        `<div class=\"${PREVIEW_CLASS}\" aria-hidden=\"true\">${previewImage}${fileName}<div>`\r\n      );\r\n    };\r\n\r\n    // Not all files will be able to generate previews. In case this happens, we provide several types \"generic previews\" based on the file extension.\r\n    reader.onloadend = function createFilePreview() {\r\n      const imageId = makeSafeForID(fileName);\r\n      const previewImage = document.getElementById(imageId);\r\n      if (fileName.indexOf('.pdf') > 0) {\r\n        previewImage.setAttribute(\r\n          'onerror',\r\n          `this.onerror=null;this.src=\"${SPACER_GIF}\"; this.classList.add(\"${PDF_PREVIEW_CLASS}\")`\r\n        );\r\n      }\r\n      else if (\r\n        fileName.indexOf('.doc') > 0 ||\r\n        fileName.indexOf('.pages') > 0\r\n      ) {\r\n        previewImage.setAttribute(\r\n          'onerror',\r\n          `this.onerror=null;this.src=\"${SPACER_GIF}\"; this.classList.add(\"${WORD_PREVIEW_CLASS}\")`\r\n        );\r\n      }\r\n      else if (\r\n        fileName.indexOf('.xls') > 0 ||\r\n        fileName.indexOf('.numbers') > 0\r\n      ) {\r\n        previewImage.setAttribute(\r\n          'onerror',\r\n          `this.onerror=null;this.src=\"${SPACER_GIF}\"; this.classList.add(\"${EXCEL_PREVIEW_CLASS}\")`\r\n        );\r\n      }\r\n      else if (fileName.indexOf('.mov') > 0 || fileName.indexOf('.mp4') > 0) {\r\n        previewImage.setAttribute(\r\n          'onerror',\r\n          `this.onerror=null;this.src=\"${SPACER_GIF}\"; this.classList.add(\"${VIDEO_PREVIEW_CLASS}\")`\r\n        );\r\n      }\r\n      else {\r\n        previewImage.setAttribute(\r\n          'onerror',\r\n          `this.onerror=null;this.src=\"${SPACER_GIF}\"; this.classList.add(\"${GENERIC_PREVIEW_CLASS}\")`\r\n        );\r\n      }\r\n\r\n      // Removes loader and displays preview\r\n      previewImage.classList.remove(LOADING_CLASS);\r\n      previewImage.src = reader.result;\r\n    };\r\n\r\n    if (fileNames[i]) {\r\n      reader.readAsDataURL(fileNames[i]);\r\n    }\r\n\r\n    // Adds heading above file previews, pluralizes if there are multiple\r\n    if (i === 0) {\r\n      dropTarget.insertBefore(filePreviewsHeading, instructions);\r\n      filePreviewsHeading.innerHTML =\r\n        'Selected file <span class=\"usa-file-input__choose\">Change file</span>';\r\n    }\r\n    else if (i >= 1) {\r\n      dropTarget.insertBefore(filePreviewsHeading, instructions);\r\n      filePreviewsHeading.innerHTML = `${i +\r\n        1} files selected <span class=\"usa-file-input__choose\">Change files</span>`;\r\n    }\r\n\r\n    // Hides null state content and sets preview heading class\r\n    if (filePreviewsHeading) {\r\n      instructions.classList.add(HIDDEN_CLASS);\r\n      filePreviewsHeading.classList.add(PREVIEW_HEADING_CLASS);\r\n    }\r\n  }\r\n};\r\n\r\nconst fileInput = behavior(\r\n  {},\r\n  {\r\n    init(root) {\r\n      select(DROPZONE, root).forEach((fileInputEl) => {\r\n        const { instructions, dropTarget } = buildFileInput(fileInputEl);\r\n\r\n        dropTarget.addEventListener(\r\n          'dragover',\r\n          function handleDragOver() {\r\n            this.classList.add(DRAG_CLASS);\r\n          },\r\n          false\r\n        );\r\n\r\n        dropTarget.addEventListener(\r\n          'dragleave',\r\n          function handleDragLeave() {\r\n            this.classList.remove(DRAG_CLASS);\r\n          },\r\n          false\r\n        );\r\n\r\n        dropTarget.addEventListener(\r\n          'drop',\r\n          function handleDrop(e) {\r\n            preventInvalidFiles(e, fileInputEl, instructions, dropTarget);\r\n            this.classList.remove(DRAG_CLASS);\r\n          },\r\n          false\r\n        );\r\n\r\n        fileInputEl.onchange = (e) => {\r\n          // eslint-disable-line no-param-reassign\r\n          handleChange(e, fileInputEl, instructions, dropTarget);\r\n        };\r\n      });\r\n    }\r\n  }\r\n);\r\n\r\nmodule.exports = fileInput;\r\n"],"file":"file-input.js"}